{% extends '@YesknBlog/base.html.twig' %}

{% block main %}
    <div class="home-content-main">
        <div class="tab-list">
            <a data-pjax class="{{ tab == 'all' ? 'current-tab':'' }}" href="/">{{ '全部'|trans }}</a>
            <a data-pjax class="{{ tab == 'hot' ? 'current-tab':'' }}"  href="{{ path('home_tab', {tab: 'hot'}) }}">{{ '热门'|trans }}</a>

            {% for tabItem in tabs %}
                <a data-pjax class="{{ tab == tabItem.alias ? 'current-tab':'' }}"  href="{{ path('home_tab', {tab: tabItem.alias}) }}">{{ tabItem.name|trans }}</a>
            {% endfor %}
        </div>
        {% if posts is not empty %}
            {% for post in posts %}
                <article class="main" style="position: relative">
                    <div class="row">
                        <div class="col-md-1 post-avatar">
                            <img src="{{ asset(post.author.avatar) }}" class="img-rounded">
                        </div>
                        <div class="col-md-11 home-post-info">
                    <span class="item-title">
                        <a data-pjax href="{{ path('yeskn_blog_show' , {'id' : post.id}) }}">{{ post.title }}</a>
                    </span>
                            <p class="post-meta">
                        <span><i class="fa fa-user"></i>
                            <a data-pjax href="{{ path('user_home', {username: post.author.username}) }}">{{ post.author.nickname }}</a></span>

                                <span class="category">
                                      <a data-pjax href="{{ path('home_tab', {tab:post.tab.alias}) }}" class="badge">{{ post.tab.name|trans }}</a>
                                </span>
                                <span><i class="fa fa-clock-o"></i> {{ post.updatedAt ? post.updatedAt|ago : post.createdAt|ago }}</span>
                                <span><i class="fa fa-eye"></i> {{ post.views }}{{ 'click'|trans }}</span>
                                {% if post.comments.count %}
                                    <span><i class="fa fa-commenting-o"></i>
                                        <a data-pjax href="{{ path('yeskn_blog_show', {id:post.id}) }}#comments">{{ post.comments.count }}{{ 'comment'|trans }}</a></span>
                                {% endif %}
                            </p>
                        </div>
                    </div>
                    {#{% if post.tags is not empty %}#}
                    {#<div style="position: relative;bottom:-10px">#}
                    {#<p>#}
                    {#<i class="fa  fa-tags item-tag"></i>#}
                    {#{% for tag in post.tags %}#}
                    {#<span class="item-tag"> {{ tag.name }} </span>#}
                    {#{% endfor %}#}
                    {#</p>#}
                    {#</div>#}
                    {#{% endif %}#}
                </article>
            {% endfor %}
            <ul class="pagination">
                {% set route = tab is not empty and tab != 'all' ? 'home_tab_paged' : 'blog_index_paginated' %}
                {% if pageData.currentPage == 1 %}
                    <li class="disabled">
                        <a href="#">&laquo;</a>
                    </li>
                {% else %}
                    <li>
                        <a href="{{ path(route, {page:pageData['currentPage']-1,tab:tab}) }}" data-pjax>&laquo;</a>
                    </li>
                {% endif %}

                {% if pageData.currentPage > 3 %}
                    <li class="disabled">
                        <a href="#">...</a>
                    </li>
                {% endif %}

                {% for p in 1..pageData.allPage %}
                    {% if p < pageData.currentPage - 2 %}
                    {% endif %}

                    {% if p == pageData.currentPage %}
                        <li class="active"><a href="javascript:">{{ p }}</a></li>
                    {% endif %}


                    {% if p >= pageData.currentPage - 2 and p != pageData.currentPage and p <= pageData.currentPage+2 %}
                        <li><a href="{{ path(route, {'page':p, tab:tab}) }}" data-pjax>{{ p }}</a></li>
                    {% endif %}


                    {% if p > pageData.currentPage+2 %}
                    {% endif %}
                {% endfor %}

                {% if pageData.allPage > pageData.currentPage+2 %}
                    <li class="disabled">
                        <a href="#">...</a>
                    </li>
                {% endif %}

                <li {% if pageData.currentPage == pageData.allPage %} class="disabled" {% endif %}>
                    <a href="{{ path(route, {page:pageData['currentPage']+1,tab:tab}) }}" data-pjax>&raquo;
                    </a>
                </li>
            </ul>
        {% else %}
            <div class="well">{{ '暂时没有任何文档！' }}</div>
        {% endif %}
    </div>
{% endblock %}

